[
    {
        "$match": {
            "statement.verb.id": "https://w3id.org/xapi/dod-isd/verbs/completed",
            "statement.actor.name": "___"
        }
    },
    {
        "$project": {
            "userName": "$statement.actor.name",
            "email": "$statement.actor.account.name",
            "grade": "$statement.result.score.scaled"
        }
    },
    {
        "$group": {
            "_id": {
                "name": "$userName",
                "email": "$email"
            },
            "average_score": {
                "$avg": "$grade"
            },
            "assignments": {
                "$push": "$grade"
            }
        }
    }
]